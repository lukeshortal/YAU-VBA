SELECT DISTINCT Cs_INPEXCCP_BL.FCS, IIf(Len([SMARTPARTLINK])>0,Left([SMARTPARTLINK],InStr([SMARTPARTLINK],".")-1),"") AS [SMART PART], IIf(InStr([DCSTAG],"-"),Left([DCSTAG],InStr([DCSTAG],"-")-1),IIf(InStr([DCSTAG],"_"),Left([DCSTAG],InStr([DCSTAG],"_")-1),IIf(InStr([DCSTAG],"."),Left([DCSTAG],InStr([DCSTAG],".")-1),[DCSTAG]))) AS PIDTAG
FROM Cs_INPEXCCP_BL
WHERE (((Cs_INPEXCCP_BL.FCS) Like "*02") AND ((IIf(Len([SMARTPARTLINK])>0,Left([SMARTPARTLINK],InStr([SMARTPARTLINK],".")-1),"")) Not Like "") AND ((IIf(InStr([DCSTAG],"-"),Left([DCSTAG],InStr([DCSTAG],"-")-1),IIf(InStr([DCSTAG],"_"),Left([DCSTAG],InStr([DCSTAG],"_")-1),IIf(InStr([DCSTAG],"."),Left([DCSTAG],InStr([DCSTAG],".")-1),[DCSTAG])))) Not Like "*%%*"))
ORDER BY IIf(Len([SMARTPARTLINK])>0,Left([SMARTPARTLINK],InStr([SMARTPARTLINK],".")-1),""), IIf(InStr([DCSTAG],"-"),Left([DCSTAG],InStr([DCSTAG],"-")-1),IIf(InStr([DCSTAG],"_"),Left([DCSTAG],InStr([DCSTAG],"_")-1),IIf(InStr([DCSTAG],"."),Left([DCSTAG],InStr([DCSTAG],".")-1),[DCSTAG])));
